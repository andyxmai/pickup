{% extends "base.html" %}

{% block navlist %}
{% endblock %}

{% block content %}
<div class="container">
	<section>
		<h3>Welcome to Reqtime, {{user.first_name}}!</h3>
		<div class="progress">
		  <div class="progress-bar" role="progressbar" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100" style="width: 30%;">
		    30%
		  </div>
		</div>
		<div>
			<h5>What are you favorite sports?</h5>
			<br/>
			<div id="sports_select">
				<ul>
					<li><a href="#" value="basketball">Basketball</a></li>
					<li><a href="#" value="football">Football</a></li>
					<li><a href="#" value="frisbee">Frisbee</a></li>
					<li><a href="#" value="golf">Golf</a></li>
					<li><a href="#" value="soccer">Soccer</a></li>
					<li><a href="#" value="volleyball">Volleyball</a></li>
				</ul>
			</div>
		</div>
		<br />
		<div>
			<a type="button" id="next_step_button" class="btn btn-primary disabled" style="float:right">Next</a>
		</div>
	</section>
</div>
{% endblock %}

{% block javascript %}
<script>
$("#sports_select li a").click(function() {
	var sport = $(this).attr("value");
	var sports = localStorage.getItem("sports");
	var obj ={};
	
	if($(this).hasClass("selected")) {
		if(sports){
		   obj = JSON.parse(sports);  
		}
		if(sport in obj) {
			delete obj[sport];
			if (jQuery.isEmptyObject(obj)) {
				if (!($("#next_step_button").hasClass("disabled"))) {
					$("#next_step_button").addClass("disabled");
				}
			}
		}

		$(this).removeClass("selected");
	} else {
		$(this).addClass("selected");
		console.log(sport);
		console.log(sports);
		if(sports){
		   obj = JSON.parse(sports);  
		}
		if (!(sport in obj)) {
			console.log('here');
			obj[sport] = true;
		}

		if ($("#next_step_button").hasClass("disabled")) {
			$("#next_step_button").removeClass("disabled");
		}
	}

	localStorage.setItem("sports",JSON.stringify(obj));

	console.log(JSON.parse(localStorage.getItem("sports")));
});
$("#next_step_button").click(function() {
	$.ajax({
	  type: "POST",
	  url: "/first_login/",
	  data: { 
	    'csrfmiddlewaretoken':'{{csrf_token}}',
	    'sports': localStorage.getItem("sports")
	  },
	  success: function(data) {
	    window.location.href = '/first_login2'
	  },
	});
});
</script>
{% endblock %}